pipeline{
    agent{
        label 'Agent-1'
    }
    options{
        timeout(time: 30, unit: 'MINUTES')
        disableConcurrentBuilds()
        ansiColor('xterm')
    }
    parameters{
        choice(name: 'CHOICE', choices: ['Apply', 'Destroy'], description: 'Choose terraform action')
    }
    stages{
        stage('Terraform init & apply'){
            steps{
                   
                    sh """
                        cd terraform-jenkins/00-vpc
                        echo 'Hi helloo'
                    """
                   }

            }
        
        
        stage('Terraform destroy'){
            
            steps{
                
                sh """
                    cd terraform-jenkins/00-vpc
                    echo 'Hi helloo from stage destroy'
                """
                }
            }
        }

    
    post {
        always{
            echo "This sections runs always"
            deleteDir()
        }
        success{
            echo "This section run when pipeline success"
        }
        failure{
            echo "This section run when pipeline failure"
        }
    }
        
}